aes(x = Pred, y = True, fill = Prop)
) +
scale_fill_gradient(
name = "Row 1 scale",
low = "#e8bf9c",
high = "#ff7f0e"
) +
# --- Add a new fill scale ---
new_scale_fill() +
# --- Second row ---
geom_tile(
data = filter(cm, True == "Positive"),
aes(x = Pred, y = True, fill = Prop)
) +
scale_fill_gradient(
name = "Row 2 scale",
low = "#89b2cf",
high = "#1f77b4"
) +
ggplot2::theme_minimal(base_size = 12) +
ggplot2::theme(
# axis.text.x = ggplot2::element_text(angle = 45, hjust = 1),
plot.title = ggplot2::element_text(face = "bold", size = 12),
legend.position="bottom",
legend.text = ggplot2::element_text(angle = 45, hjust = 1)
)
library(ggplot2)
ggplot() +
# --- First row ---
geom_tile(
data = filter(cm, True == "Negative"),
aes(x = Pred, y = True, fill = Prop)
) +
scale_fill_gradient(
name = "Row 1 scale",
low = "#e8bf9c",
high = "#ff7f0e"
) +
# --- Add a new fill scale ---
new_scale_fill() +
# --- Second row ---
geom_tile(
data = filter(cm, True == "Positive"),
aes(x = Pred, y = True, fill = Prop)
) +
scale_fill_gradient(
name = "Row 2 scale",
low = "#89b2cf",
high = "#1f77b4"
) +
ggplot2::theme_minimal(base_size = 12) +
ggplot2::theme(
# axis.text.x = ggplot2::element_text(angle = 45, hjust = 1),
plot.title = ggplot2::element_text(face = "bold", size = 12),
legend.position="bottom",
legend.text = ggplot2::element_text(angle = 45, hjust = 1)
)
ggplot() +
# --- First row ---
geom_tile(
data = filter(cm, cm$True == "Negative"),
aes(x = Pred, y = True, fill = Prop)
) +
scale_fill_gradient(
name = "Row 1 scale",
low = "#e8bf9c",
high = "#ff7f0e"
) +
# --- Add a new fill scale ---
new_scale_fill() +
# --- Second row ---
geom_tile(
data = filter(cm, cm$True == "Positive"),
aes(x = Pred, y = True, fill = Prop)
) +
scale_fill_gradient(
name = "Row 2 scale",
low = "#89b2cf",
high = "#1f77b4"
) +
ggplot2::theme_minimal(base_size = 12) +
ggplot2::theme(
# axis.text.x = ggplot2::element_text(angle = 45, hjust = 1),
plot.title = ggplot2::element_text(face = "bold", size = 12),
legend.position="bottom",
legend.text = ggplot2::element_text(angle = 45, hjust = 1)
)
library(dplyr)
ggplot() +
# --- First row ---
geom_tile(
data = filter(cm, cm$True == "Negative"),
aes(x = Pred, y = True, fill = Prop)
) +
scale_fill_gradient(
name = "Row 1 scale",
low = "#e8bf9c",
high = "#ff7f0e"
) +
# --- Add a new fill scale ---
new_scale_fill() +
# --- Second row ---
geom_tile(
data = filter(cm, cm$True == "Positive"),
aes(x = Pred, y = True, fill = Prop)
) +
scale_fill_gradient(
name = "Row 2 scale",
low = "#89b2cf",
high = "#1f77b4"
) +
ggplot2::theme_minimal(base_size = 12) +
ggplot2::theme(
# axis.text.x = ggplot2::element_text(angle = 45, hjust = 1),
plot.title = ggplot2::element_text(face = "bold", size = 12),
legend.position="bottom",
legend.text = ggplot2::element_text(angle = 45, hjust = 1)
)
ggplot() +
# --- First row ---
geom_tile(
data = filter(cm, cm$True == "Negative"),
aes(x = Pred, y = True, fill = Freq)
) +
scale_fill_gradient(
name = "Row 1 scale",
low = "#e8bf9c",
high = "#ff7f0e"
) +
# --- Add a new fill scale ---
new_scale_fill() +
# --- Second row ---
geom_tile(
data = filter(cm, cm$True == "Positive"),
aes(x = Pred, y = True, fill = Freq)
) +
scale_fill_gradient(
name = "Row 2 scale",
low = "#89b2cf",
high = "#1f77b4"
) +
ggplot2::theme_minimal(base_size = 12) +
ggplot2::theme(
# axis.text.x = ggplot2::element_text(angle = 45, hjust = 1),
plot.title = ggplot2::element_text(face = "bold", size = 12),
legend.position="bottom",
legend.text = ggplot2::element_text(angle = 45, hjust = 1)
)
usethis::use_package("ggnewscale")
attachment::att_amend_desc()
shiny::runApp()
usethis::use_package("pool")
usethis::use_package("bslib")
usethis::use_package("dplyr")
usethis::use_pipe()
usethis::use_package("DBI")
usethis::use_package("ggplot2")
usethis::use_package("pROC")
usethis::use_package("glue")
usethis::use_package("plotly")
usethis::use_package("RSQLite")
usethis::use_package("ggnewscale")
attachment::att_amend_desc()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
classif_type="major_classif"
if (!exists("food_category") || is.null(food_category) || food_category == "" || is.na(food_category)) {
q1 <- paste0("SELECT category_id,name FROM categories WHERE type = '", classif_type, "'")
} else {
q1 <- paste0("SELECT category_id,name FROM categories WHERE type = '", classif_type,
"' AND name = '", food_category, "'")
}
category_mapper <- DBI::dbGetQuery(con, q1)
db_path <- system.file("extdata", "eir_data.sqlite", package = "DNBCFoodTextClassifier")
con <- DBI::dbConnect(RSQLite::SQLite(), db_path)
if (!exists("food_category") || is.null(food_category) || food_category == "" || is.na(food_category)) {
q1 <- paste0("SELECT category_id,name FROM categories WHERE type = '", classif_type, "'")
} else {
q1 <- paste0("SELECT category_id,name FROM categories WHERE type = '", classif_type,
"' AND name = '", food_category, "'")
}
category_mapper <- DBI::dbGetQuery(con, q1)
if (!exists("food_category") || is.null(food_category) || food_category == "" || is.na(food_category)) {
q1 <- paste0("SELECT category_id FROM categories WHERE type = '", classif_type, "'")
} else {
q1 <- paste0("SELECT category_id FROM categories WHERE type = '", classif_type,
"' AND name = '", food_category, "'")
}
category_id <- DBI::dbGetQuery(con, q1)$category_id
q2 <- paste0("SELECT * FROM predictions WHERE category_id IN (", paste(category_id, collapse = ","),")")
pred_data <- DBI::dbGetQuery(con, q2) %>%
dplyr::mutate(true_label_factor = factor(true_label, levels = c(0, 1),
labels = c("Negative", "Positive")))
if (!exists("food_category") || is.null(food_category) || food_category == "" || is.na(food_category)) {
q1 <- paste0("SELECT category_id FROM categories WHERE type = '", classif_type, "'")
} else {
q1 <- paste0("SELECT category_id FROM categories WHERE type = '", classif_type,
"' AND name = '", food_category, "'")
}
category_id <- DBI::dbGetQuery(con, q1)$category_id
q2 <- paste0("SELECT * FROM metrics WHERE category_id IN (", paste(category_id, collapse = ","),")")
metric_data <- DBI::dbGetQuery(con, q2)
categ_data <- category_mapper
scatter_plot_data <- pred_data %>%
dplyr::mutate(
pred_class = ifelse(predicted_value_1 > predicted_value_0, "Positive", "Negative")
) %>%
dplyr::group_by(category_id, true_label_factor, pred_class) %>%
dplyr::summarise(true_positives = n(), .groups = "drop") %>%
dplyr::filter(true_label_factor == "Positive", pred_class == "Positive") %>%
dplyr::select(category_id, true_positives) %>%
dplyr::full_join(metric_data, by = "category_id") %>%
dplyr::full_join(categ_data, by = "category_id") %>%
tidyr::pivot_longer(
cols = c(mcc, acc, roc_auc_macro, ap_macro),
names_to = "metric",
values_to = "value"
)
View(scatter_plot_data)
ggplot2::ggplot(scatter_plot_data, ggplot2::aes(x = true_positives, y = value, colour = name)) +
ggplot2::geom_point(alpha = 0.7, size = 2) +
ggplot2::ylim(0,1)+
ggplot2::facet_wrap(~ metric) +
ggplot2::theme_minimal(base_size = 12) +
ggplot2::labs(
x = "True Positives",
y = "Metric Value",
title = "Performance Metrics vs True Positives"
) +
ggplot2::theme(legend.position = "none")
head(scatter_plot_data)
ggplot2::ggplot(scatter_plot_data, ggplot2::aes(x = true_positives, y = value, colour = name)) +
ggplot2::geom_point(alpha = 0.7, size = 2) +
ggplot2::stat_summary(
ggplot2::aes(group = metric),
fun = mean,
geom = "hline",
linetype = "dashed",
color = "black",
linewidth = 0.7
) +
ggplot2::ylim(0,1)+
ggplot2::facet_wrap(~ metric) +
ggplot2::theme_minimal(base_size = 12) +
ggplot2::labs(
x = "True Positives",
y = "Metric Value",
title = "Performance Metrics vs True Positives"
) +
ggplot2::theme(legend.position = "none")
ggplot2::ggplot(scatter_plot_data, ggplot2::aes(x = true_positives, y = value, colour = name)) +
ggplot2::geom_point(alpha = 0.7, size = 2) +
ggplot2::stat_summary(
ggplot2::aes(group = metric),
fun = "mean",
geom = "hline",
linetype = "dashed",
color = "black",
linewidth = 0.7
) +
ggplot2::ylim(0,1)+
ggplot2::facet_wrap(~ metric) +
ggplot2::theme_minimal(base_size = 12) +
ggplot2::labs(
x = "True Positives",
y = "Metric Value",
title = "Performance Metrics vs True Positives"
) +
ggplot2::theme(legend.position = "none")
ggplot2::ggplot(scatter_plot_data, ggplot2::aes(x = true_positives, y = value, colour = name)) +
ggplot2::geom_point(alpha = 0.7, size = 2) +
ggplot2::stat_summary(
ggplot2::aes(group = metric),
fun = "median",
geom = "hline",
linetype = "dashed",
color = "black",
linewidth = 0.7
) +
ggplot2::ylim(0,1)+
ggplot2::facet_wrap(~ metric) +
ggplot2::theme_minimal(base_size = 12) +
ggplot2::labs(
x = "True Positives",
y = "Metric Value",
title = "Performance Metrics vs True Positives"
) +
ggplot2::theme(legend.position = "none")
ggplot2::ggplot(scatter_plot_data, ggplot2::aes(x = true_positives, y = value, colour = name)) +
ggplot2::geom_point(alpha = 0.7, size = 2) +
ggplot2::stat_summary(
ggplot2::aes(group = metric),
fun = "median",
geom = "point",
linetype = "dashed",
color = "black",
linewidth = 0.7
) +
ggplot2::ylim(0,1)+
ggplot2::facet_wrap(~ metric) +
ggplot2::theme_minimal(base_size = 12) +
ggplot2::labs(
x = "True Positives",
y = "Metric Value",
title = "Performance Metrics vs True Positives"
) +
ggplot2::theme(legend.position = "none")
ggplot2::ggplot(scatter_plot_data, ggplot2::aes(x = true_positives, y = value, colour = name)) +
ggplot2::geom_point(alpha = 0.7, size = 2) +
ggplot2::stat_summary(
ggplot2::aes(group = metric),
fun = mean,
geom = "line",
linetype = "dashed",
color = "black",
linewidth = 0.7
) +
ggplot2::ylim(0,1)+
ggplot2::facet_wrap(~ metric) +
ggplot2::theme_minimal(base_size = 12) +
ggplot2::labs(
x = "True Positives",
y = "Metric Value",
title = "Performance Metrics vs True Positives"
) +
ggplot2::theme(legend.position = "none")
ggplot2::ggplot(scatter_plot_data, ggplot2::aes(x = true_positives, y = value, colour = name)) +
ggplot2::geom_point(alpha = 0.7, size = 2) +
ggplot2::geom_hline(
data = mean_lines,
ggplot2::aes(yintercept = mean_value),
linetype = "dashed",
color = "black",
linewidth = 0.7
) +
ggplot2::ylim(0,1)+
ggplot2::facet_wrap(~ metric) +
ggplot2::theme_minimal(base_size = 12) +
ggplot2::labs(
x = "True Positives",
y = "Metric Value",
title = "Performance Metrics vs True Positives"
) +
ggplot2::theme(legend.position = "none")
mean_lines <- scatter_plot_data %>%
group_by(metric) %>%
summarise(mean_value = mean(value, na.rm = TRUE))
ggplot2::ggplot(scatter_plot_data, ggplot2::aes(x = true_positives, y = value, colour = name)) +
ggplot2::geom_point(alpha = 0.7, size = 2) +
ggplot2::geom_hline(
data = mean_lines,
ggplot2::aes(yintercept = mean_value),
linetype = "dashed",
color = "black",
linewidth = 0.7
) +
ggplot2::ylim(0,1)+
ggplot2::facet_wrap(~ metric) +
ggplot2::theme_minimal(base_size = 12) +
ggplot2::labs(
x = "True Positives",
y = "Metric Value",
title = "Performance Metrics vs True Positives"
) +
ggplot2::theme(legend.position = "none")
ggplot2::ggplot(scatter_plot_data, ggplot2::aes(x = true_positives, y = value, colour = name)) +
ggplot2::geom_point(alpha = 0.7, size = 2) +
ggplot2::geom_hline(
data = mean_lines,
ggplot2::aes(yintercept = mean_value),
linetype = "dashed",
color = "grey",
linewidth = 0.7
) +
ggplot2::ylim(0,1)+
ggplot2::facet_wrap(~ metric) +
ggplot2::theme_minimal(base_size = 12) +
ggplot2::labs(
x = "True Positives",
y = "Metric Value",
title = "Performance Metrics vs True Positives"
) +
ggplot2::theme(legend.position = "none")
ggplot2::ggplot(scatter_plot_data, ggplot2::aes(x = true_positives, y = value, colour = name)) +
ggplot2::geom_point(alpha = 0.7, size = 2) +
ggplot2::geom_hline(
data = mean_lines,
ggplot2::aes(yintercept = mean_value),
linetype = "dashed",
color = "darkgrey",
linewidth = 0.7
) +
ggplot2::ylim(0,1)+
ggplot2::facet_wrap(~ metric) +
ggplot2::theme_minimal(base_size = 12) +
ggplot2::labs(
x = "True Positives",
y = "Metric Value",
title = "Performance Metrics vs True Positives"
) +
ggplot2::theme(legend.position = "none")
ggplot2::ggplot(scatter_plot_data, ggplot2::aes(x = true_positives, y = value, colour = name)) +
ggplot2::geom_point(alpha = 0.7, size = 2) +
ggplot2::geom_hline(
data = mean_lines,
ggplot2::aes(yintercept = mean_value),
linetype = "dashed",
color = "#979797",
linewidth = 0.7
) +
ggplot2::ylim(0,1)+
ggplot2::facet_wrap(~ metric) +
ggplot2::theme_minimal(base_size = 12) +
ggplot2::labs(
x = "True Positives",
y = "Metric Value",
title = "Performance Metrics vs True Positives"
) +
ggplot2::theme(legend.position = "none")
ggplot2::ggplot(scatter_plot_data, ggplot2::aes(x = true_positives, y = value, colour = name)) +
ggplot2::geom_point(alpha = 0.7, size = 2) +
ggplot2::geom_hline(
data = mean_lines,
ggplot2::aes(yintercept = mean_value),
linetype = "dashed",
color = "#747474",
linewidth = 0.7
) +
ggplot2::ylim(0,1)+
ggplot2::facet_wrap(~ metric) +
ggplot2::theme_minimal(base_size = 12) +
ggplot2::labs(
x = "True Positives",
y = "Metric Value",
title = "Performance Metrics vs True Positives"
) +
ggplot2::theme(legend.position = "none")
runApp()
ggplot2::ggplot(scatter_plot_data, ggplot2::aes(x = true_positives, y = value, colour = name)) +
ggplot2::geom_point(alpha = 0.7, size = 2) +
ggplot2::geom_hline(
data = mean_lines,
ggplot2::aes(yintercept = mean_value),
linetype = "dashed",
color = "#929395",
linewidth = 0.7
) +
ggplot2::ylim(0,1)+
ggplot2::facet_wrap(~ metric) +
ggplot2::theme_minimal(base_size = 12) +
ggplot2::labs(
x = "True Positives",
y = "Metric Value",
title = "Performance Metrics vs True Positives"
) +
ggplot2::theme(legend.position = "none")
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
View(scatter_plot_data)
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
usethis::use_package("pool")
usethis::use_package("bslib")
usethis::use_package("dplyr")
usethis::use_pipe()
usethis::use_package("DBI")
usethis::use_package("ggplot2")
usethis::use_package("pROC")
usethis::use_package("glue")
usethis::use_package("plotly")
usethis::use_package("RSQLite")
usethis::use_package("ggnewscale")
attachment::att_amend_desc()
attachment::att_amend_desc()
usethis::use_package("bslib")
usethis::use_package("dplyr")
usethis::use_pipe()
usethis::use_package("DBI")
usethis::use_package("ggplot2")
usethis::use_package("pROC")
usethis::use_package("plotly")
usethis::use_package("RSQLite")
usethis::use_package("ggnewscale")
attachment::att_amend_desc()
shiny::runApp()
R.version
runApp()
shiny::runApp('DNBCFoodTextClassifier-main')
shiny::runApp('DNBCFoodTextClassifier')
shiny::runApp()
renv::snapshot()
renv::restore()
shiny::runApp()
runApp()
shiny::runApp()
runApp()
shiny::runApp()
